!function n(s,i,l){function r(e,t){if(!i[e]){if(!s[e]){var a="function"==typeof require&&require;if(!t&&a)return a(e,!0);if(o)return o(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}a=i[e]={exports:{}},s[e][0].call(a.exports,function(t){return r(s[e][1][t]||t)},a,a.exports,n,s,i,l)}return i[e].exports}for(var o="function"==typeof require&&require,t=0;t<l.length;t++)r(l[t]);return r}({1:[function(t,e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=n(t("../global/Fluency")),d=n(t("../global/FtConfig")),g=n(t("../ui/FtActivityOverlay"));function n(t){return t&&t.__esModule?t:{default:t}}t=function(){const t="data-ft-initialized";return{initializedAttr:t,init:()=>{[...document.querySelectorAll(`.ft-standalone-translator-fieldset:not([${t}])`)].forEach(t=>{new s(t)})}}}();const s=function(t){let n,s,i,l,r,o=d.default.getUiTextFor("standaloneTranslator");const u={sourceLanguageSelect:"ft-source-language",targetLanguageSelect:"ft-target-language",sourceContentInputfield:"ft-source-content",translatedContentInputfield:"ft-translated-content",translateButton:"js-ft-translate",copyButton:"ft-click-to-copy",clearButton:"ft-click-to-clear",swapButton:"js-ft-swap-languages"};this.cacheElements=()=>{u.translateButton=t.querySelector("."+u.translateButton),u.swapButton=document.querySelector("."+u.swapButton),u.sourceLanguageSelect=t.querySelector("."+u.sourceLanguageSelect).closest("li.Inputfield"),u.targetLanguageSelect=t.querySelector("."+u.targetLanguageSelect).closest("li.Inputfield"),u.sourceContentInputfield=t.querySelector("."+u.sourceContentInputfield).closest("li.Inputfield"),u.translatedContentInputfield=t.querySelector("."+u.translatedContentInputfield).closest("li.Inputfield")},this.getSelf=()=>t,this.bindTranslateButton=()=>{u.translateButton.addEventListener("click",t=>{t.preventDefault();var t=l.getValue(),e=r.getValue(),a=s.getContent();t||l.indicateError(),e||r.indicateError(),a||s.indicateError(),t&&e&&a&&(n.showActivity(),c.default.getTranslation(t,e,a).then(t=>{t.error&&n.showError(t.message),i.setContent(t.translations[0]),n.hide()}))})},this.selectedLanguages={source:null,target:null},this.bindLanguageSwapButton=()=>{u.swapButton.addEventListener("click",t=>{t.preventDefault(),this.swapLanguageSelectValues(),this.swapTranslationContent()})},this.swapTranslationContent=()=>{var t=s.getContent(),e=i.getContent();s.setContent(e),i.setContent(t)},this.swapLanguageSelectValues=()=>{var t=this.selectedLanguages.source,e=this.selectedLanguages.target,a=l.getOptions(),n=r.getOptions(),a=this.getLanguageSwapValue("target",a),n=this.getLanguageSwapValue("source",n);l.setValue(a),r.setValue(n),this.selectedLanguages.source=e,this.selectedLanguages.target=t},this.getLanguageSwapValue=(t,e)=>{var t=this.selectedLanguages[t];return e.includes(t)?t:(t=t.split("-")[0],(t=e.map(t=>t.split("-")[0]).indexOf(t))?e[t]:void 0)},this.initLanguageSwapButtonState=()=>{var t=l.getValue(),e=r.getValue();this.selectedLanguages.source=t,this.selectedLanguages.target=e,t&&e?this.setSwapButtonState.enabled():this.setSwapButtonState.disabled()},this.setSwapButtonState={enabled:()=>u.swapButton.disabled=!1,disabled:()=>u.swapButton.disabled=!0},this.addClearContentButton=()=>{var t=u.clearButton,e=(u.clearButton=document.createElement("a"),u.clearButton.setAttribute("class",t),document.createElement("i")),a=(e.setAttribute("class","ft-clear-icon fa fa-fw fa-trash-o"),document.createElement("span")),a=(a.innerText=o.clickToClear,a.setAttribute("class","ft-clear-text"),u.clearButton.append(a,e),u.sourceContentInputfield.querySelector(".InputfieldHeader"));a.classList.add(t+"-container"),a.appendChild(u.clearButton),this.bindClearContentButton()},this.bindClearContentButton=()=>{u.clearButton.addEventListener("click",t=>{t.preventDefault(),s.clearContent(),i.clearContent()})},this.addCopyContentButton=()=>{var t=u.copyButton,e=(u.copyButton=document.createElement("a"),u.copyButton.setAttribute("class",t),document.createElement("i")),a=(e.setAttribute("class","ft-copy-icon fa fa-fw fa-clone"),document.createElement("span")),a=(a.innerText=o.clickToCopy,a.setAttribute("class","ft-copy-text"),u.copyButton.append(a,e),u.translatedContentInputfield.querySelector(".InputfieldHeader"));a.classList.add(t+"-container"),a.appendChild(u.copyButton),this.bindCopyContentButton()},this.bindCopyContentButton=()=>{u.copyButton.addEventListener("click",t=>{t.preventDefault();t=i.getContent();t&&navigator.clipboard.writeText(t).then(()=>{i.indicateSuccess(o.copied)})})},this.toggleCopyContentButton=t=>{t?u.copyButton.classList.add("enabled"):u.copyButton.classList.remove("enabled")},this.createInputControllers=()=>{l=new h("source",u.sourceLanguageSelect,this.languageSelectCallback),r=new h("target",u.targetLanguageSelect,this.languageSelectCallback),s=new f(u.sourceContentInputfield),i=new f(u.translatedContentInputfield,this.toggleCopyContentButton)},this.languageSelectCallback=(t,e)=>{var a=t.getType(),t=t.getValue();this.selectedLanguages[a]=t||null,t?this.setSwapButtonState.enabled():this.setSwapButtonState.disabled()},this.cacheElements(),this.createInputControllers(),n=new g.default(this),this.addCopyContentButton(),this.addClearContentButton(),this.bindTranslateButton(),this.initLanguageSwapButtonState(),this.bindLanguageSwapButton()},h=function(t,e,a){let n,s;this.getType=()=>t,this.getSelf=()=>e,this.getValue=()=>s.value||null,this.setValue=t=>s.value=t,this.getOptions=()=>[...s.options].map(t=>t.value).filter(t=>!!t),this.indicateError=()=>n.flashError("",300),(s=e.querySelector("select")).addEventListener("change",t=>a(this,t)),n=new g.default(this)},f=function(t,e=null){d.default.getUiTextFor("standaloneTranslator");let a;let n;this.getSelf=()=>t,this.getContent=()=>a.get(),this.setContent=t=>a.set(t),this.clearContent=()=>this.setContent(""),this.indicateError=()=>n.flashError("",300),this.indicateSuccess=t=>n.flashSuccess(t),a=new i(t,e),n=new g.default(this)},i=function(t,e=null){let a,n=!1;this.set=t=>{a.value=t,a.dispatchEvent(new Event("input"))},this.get=()=>a.value,this.bindContentChangeListener=()=>{a.addEventListener("input",t=>{t=t.target.value;t&&!n&&(n=!0,e(!0)),!t&&n&&(n=!1,e(!1))})},a=t.querySelector("textarea"),e&&this.bindContentChangeListener()};a.default=t},{"../global/Fluency":3,"../global/FtConfig":4,"../ui/FtActivityOverlay":5}],2:[function(t,e,a){"use strict";var n=i(t("./components/FtStandaloneTranslatorFieldset")),s=i(t("./global/FtConfig"));function i(t){return t&&t.__esModule?t:{default:t}}window.addEventListener("load",t=>{s.default.moduleShouldInitialize()&&n.default.init()})},{"./components/FtStandaloneTranslatorFieldset":1,"./global/FtConfig":4}],3:[function(t,e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=(t=t("./FtConfig"))&&t.__esModule?t:{default:t};t=function(){const a=u.default.getUiTextFor("errors");const l=t=>{var e={"X-Requested-With":"XMLHttpRequest"};return"GET"===t&&(e.Accept="application/json"),"POST"===t&&(e["Content-Type"]="application/json"),e},t=(t,e)=>fetch(t,{method:"GET",cache:"no-store",headers:l("GET")}).then(r).then(e).catch(o),e=(t,e)=>fetch(t,{method:"DELETE",headers:l("GET")}).then(r).then(e).catch(o),r=t=>{if(204===t.status)return t;if(t.ok)return t.json();throw new Error},o=t=>{console.error("[Fluency module API failure]",t.message);var e={error:null,message:null};return"NetworkError"===t.message.split(" ")[0]?(e.error="FLUENCY_CLIENT_DISCONNECTED",e.message=a.FLUENCY_CLIENT_DISCONNECTED):(e.error="UNKNOWN_ERROR",e.message=a.UNKNOWN_ERROR),e};return{deleteTranslatableLanguagesCache:()=>e(u.default.getApiEndpointFor("translatableLanguagesCache"),t=>t),deleteTranslationCache:()=>e(u.default.getApiEndpointFor("translationCache"),t=>t),getAvailableLanguages:()=>t(u.default.getApiEndpointFor("languages"),t=>t),getTranslation:(t,e,a,n=[],s=null)=>{return i=u.default.getApiEndpointFor("translation"),t={sourceLanguage:t,targetLanguage:e,content:a,options:n,caching:s},e=t=>t,fetch(i,{method:"POST",cache:"no-store",headers:l,body:JSON.stringify(t)}).then(r).then(e).catch(o);var i},getUsage:()=>t(u.default.getApiEndpointFor("usage"),t=>t)}}();a.default=t},{"./FtConfig":4}],4:[function(t,e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=function(){const t=ProcessWire.config.fluency;var e=t.localization;const a={translateButton:{container:"ft-translate-button-container",button:"ft-translate-button"},languageTranslator:{container:"Inputfield InputfieldHeaderHidden",content:"InputfieldContent ft-language-translator-button-content",translateButton:"ft-translate-all-button",sourceLanguageSelect:"uk-select ft-source-language-select",sourceLanguageSelectLabel:"ft-source-language-select-label"},statusPlaceholder:{container:"ft-translation-status-container",label:"ft-translation-status"},icon:"ft-icon"},n={activityOverlay:e.activityOverlay,languageSelect:e.languageSelect,inputfieldTranslateButtons:e.inputfieldTranslateButtons,standaloneTranslator:e.standaloneTranslator,usage:e.usage,errors:e.errors,languageTranslator:e.languageTranslator},s={languages:t.apiEndpoints.languages,translatableLanguagesCache:t.apiEndpoints.translatableLanguagesCache,test:t.apiEndpoints.test,translation:t.apiEndpoints.translation,translationCache:t.apiEndpoints.translationCache,usage:t.apiEndpoints.usage},i=t.configuredLanguages,l=t.unconfiguredLanguages;const r=()=>i;const o=()=>l;const u=()=>t.engine;return{fieldInitializedAttr:"data-ft-initialized",getApiEndpointFor:t=>s[t],getConfiguredLanguages:r,getDefaultLanguage:()=>i.reduce((t,e)=>e.default?e:t,null),getElementClassesFor:t=>a[t],getEngineInfo:u,getEngineProvidesUsageData:()=>u().providesUsageData,getLanguageCount:()=>i.length+l.length,getLanguageForId:a=>(a=parseInt(a,10),i.reduce((t,e)=>e.id===a?e:t,null)),getTranslationAction:()=>t.interface.inputfieldTranslationAction,getTranslationDisabledFieldAttribute:()=>`[${t.interface.translationDisabledFieldAttr}]`,getUiTextFor:t=>n[t],getUnconfiguredLanguages:o,languageIsTranslatable:t=>!l.includes(parseInt(t,10)),moduleShouldInitialize:()=>1<i.length,translationActionTypes:{each:"translate_each_language",all:"translate_to_all_languages",both:"both"}}}();a.default=n},{}],5:[function(t,e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=(t=t("../global/FtConfig"))&&t.__esModule?t:{default:t};a.default=function(t,s="translating"){const n={parent:"ft-activity-overlay-container",overlay:"ft-activity-overlay",error:"error",message:"message",flash:"flash",success:"success",activity:"activity",visible:"visible",activityContainer:"ft-activity",activityStaticText:"ft-activity-text",activityAnimationContainer:"ft-activity-animation-container",activityAnimationItem:"ft-activity-animation-item",messageContainer:"ft-activity-message"};let e,a,i;this.showActivity=()=>{this.setActivityActive(),this.setOverlayVisible()},this.showMessage=(t,e=5e3)=>{this.setMessageContent(t),this.setActivityInactive(),this.setMessageActive(),this.setOverlayVisible(),this.hide(e)},this.flashSuccess=(t,e=500)=>{this.setSuccessActive(),this.setFlashActive(),this.showMessage(t,e)},this.flashError=(t,e=500)=>{this.setFlashActive(),this.setErrorActive(),this.showMessage(t,e)},this.showError=(t,e=7e3)=>{this.setErrorActive(),this.showMessage(t,e)},this.hide=(t=0)=>{setTimeout(()=>{this.setOverlayInvisible()},t),setTimeout(()=>{this.setActivityInactive(),this.setMessageInactive(),this.setErrorInactive(),this.setFlashInactive(),this.setMessageContent("")},t+500)},this.setActivityActive=()=>{e.classList.add(n.activity)},this.setActivityInactive=()=>{e.classList.remove(n.activity)},this.setMessageActive=()=>{e.classList.add(n.message)},this.setMessageInactive=()=>{e.classList.remove(n.message)},this.setMessageContent=t=>{a.innerText=t},this.setFlashActive=t=>{e.classList.add(n.flash)},this.setFlashInactive=t=>{e.classList.remove(n.flash)},this.setSuccessActive=()=>{e.classList.add(n.success)},this.setSuccessInactive=()=>{e.classList.remove(n.success)},this.setErrorActive=()=>{e.classList.add(n.error)},this.setErrorInactive=()=>{e.classList.remove(n.error)},this.setOverlayVisible=()=>{e.classList.add(n.visible)},this.setOverlayInvisible=()=>{e.classList.remove(n.visible)},this.create=()=>(e=this.buildOverlayEl(),i=this.buildActivityEl(),a=this.buildMessageEl(),e.appendChild(i),e.appendChild(a),e),this.buildOverlayEl=()=>{var t=document.createElement("div");return t.setAttribute("class",n.overlay),t},this.buildActivityEl=()=>{var t=this.getActivityTexts();let e=document.createElement("div");e.setAttribute("class",n.activityAnimationContainer),e=t.animated.reduce((t,e)=>{var a=document.createElement("span");return a.setAttribute("class",n.activityAnimationItem),a.innerHTML=e,t.appendChild(a),t},e);var a=document.createElement("div");return a.setAttribute("class",n.activityStaticText),a.innerText=t.static,(i=document.createElement("div")).setAttribute("class",n.activityContainer),i.appendChild(a),i.appendChild(e),i},this.getActivityTexts=()=>{var t=l.default.getUiTextFor("activityOverlay")[s],e=t.animated;for(let t=e.length-1;0<t;t--){var a=Math.floor(Math.random()*(t+1)),n=e[t];e[t]=e[a],e[a]=n}return t.animated=e,t},this.buildMessageEl=()=>((a=document.createElement("div")).setAttribute("class",n.messageContainer),a),t=t.getSelf(),e=this.create(),t.classList.add(n.parent),t.appendChild(e)}},{"../global/FtConfig":4}]},{},[2]);
//# sourceMappingURL=maps/fluency_standalone_translator.bundle.js.map
