!function a(s,n,r){function o(t,e){if(!n[t]){if(!s[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(l)return l(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}i=n[t]={exports:{}},s[t][0].call(i.exports,function(e){return o(s[t][1][e]||e)},i,i.exports,a,s,n,r)}return n[t].exports}for(var l="function"==typeof require&&require,e=0;e<r.length;e++)o(r[e]);return o}({1:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=s(e("../global/Fluency")),a=s(e("../global/FtConfig")),r=s(e("../ui/FtActivityOverlay"));function s(e){return e&&e.__esModule?e:{default:e}}const o=function(){const e="data-ft-initialized";return{init:()=>{a.default.getEngineProvidesUsageData()&&[...document.querySelectorAll(`.ft-api-usage-table-fieldset:not([${e}])`)].forEach(e=>{new l(e)})},initializedAttr:e}}(),l=function(e){let t;const i={unit:"ft-usage-unit",limit:"ft-usage-limit",used:"ft-usage-used",remaining:"ft-usage-remaining",total:"ft-usage-total",refreshButton:"js-ft-refresh-usage"};this.getSelf=()=>e,this.updateView=()=>{t.showActivity(),n.default.getUsage().then(e=>{e.error?t.showError(e.message):(i.unit.innerText=e.unit,i.limit.innerText=e.limit,i.remaining.innerText=e.remaining,i.used.innerText=e.used,i.total.innerText=e.percentUsed,t.hide())})},this.bindRefreshButton=()=>{i.refreshButton.addEventListener("click",e=>{e.preventDefault(),this.updateView()})};for(var[a,s]of Object.entries(i))i[a]=e.querySelector("."+s);t=new r.default(this,"refreshing"),this.bindRefreshButton(),e.setAttribute(o.initializedAttr,!0)};e=o;i.default=e},{"../global/Fluency":3,"../global/FtConfig":4,"../ui/FtActivityOverlay":5}],2:[function(e,t,i){"use strict";var a=n(e("./components/FtApiUsageTableFieldset")),s=n(e("./global/FtConfig"));function n(e){return e&&e.__esModule?e:{default:e}}window.addEventListener("load",e=>{s.default.getEngineProvidesUsageData()&&a.default.init()})},{"./components/FtApiUsageTableFieldset":1,"./global/FtConfig":4}],3:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(e=e("./FtConfig"))&&e.__esModule?e:{default:e};e=function(){const i=c.default.getUiTextFor("errors");const r=e=>{var t={"X-Requested-With":"XMLHttpRequest"};return"GET"===e&&(t.Accept="application/json"),"POST"===e&&(t["Content-Type"]="application/json"),t},e=(e,t)=>fetch(e,{method:"GET",cache:"no-store",headers:r("GET")}).then(o).then(t).catch(l),t=(e,t)=>fetch(e,{method:"DELETE",headers:r("GET")}).then(o).then(t).catch(l),o=e=>{if(204===e.status)return e;if(e.ok)return e.json();throw new Error},l=e=>{console.error("[Fluency module API failure]",e.message);var t={error:null,message:null};return"NetworkError"===e.message.split(" ")[0]?(t.error="FLUENCY_CLIENT_DISCONNECTED",t.message=i.FLUENCY_CLIENT_DISCONNECTED):(t.error="UNKNOWN_ERROR",t.message=i.UNKNOWN_ERROR),t};return{deleteTranslatableLanguagesCache:()=>t(c.default.getApiEndpointFor("translatableLanguagesCache"),e=>e),deleteTranslationCache:()=>t(c.default.getApiEndpointFor("translationCache"),e=>e),getAvailableLanguages:()=>e(c.default.getApiEndpointFor("languages"),e=>e),getTranslation:function(e,t,i){var a,s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[],n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;return a=c.default.getApiEndpointFor("translation"),e={sourceLanguage:e,targetLanguage:t,content:i,options:s,caching:n},t=e=>e,fetch(a,{method:"POST",cache:"no-store",headers:r,body:JSON.stringify(e)}).then(o).then(t).catch(l)},getUsage:()=>e(c.default.getApiEndpointFor("usage"),e=>e)}}();i.default=e},{"./FtConfig":4}],4:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=function(){const e=ProcessWire.config.fluency;var t=e.localization;const i={activityOverlay:t.activityOverlay,languageSelect:t.languageSelect,inputfieldTranslateButtons:t.inputfieldTranslateButtons,standaloneTranslator:t.standaloneTranslator,usage:t.usage,errors:t.errors},a={languages:e.apiEndpoints.languages,translatableLanguagesCache:e.apiEndpoints.translatableLanguagesCache,test:e.apiEndpoints.test,translation:e.apiEndpoints.translation,translationCache:e.apiEndpoints.translationCache,usage:e.apiEndpoints.usage},s=e.configuredLanguages,n=e.unconfiguredLanguages;const r=()=>s;const o=()=>n;const l=()=>e.engine;return{fieldInitializedAttr:"data-ft-initialized",getApiEndpointFor:e=>a[e],getConfiguredLanguages:r,getDefaultLanguage:()=>s.reduce((e,t)=>t.default?t:e,null),getEngineInfo:l,getEngineProvidesUsageData:()=>l().providesUsageData,getInputfieldTranslationAction:()=>e.interface.inputfieldTranslationAction,getLanguageCount:()=>s.length+n.length,getLanguageForId:i=>(i=parseInt(i,10),s.reduce((e,t)=>t.id===i?t:e,null)),getUiTextFor:e=>i[e],getUnconfiguredLanguages:o,languageIsTranslatable:e=>!n.includes(parseInt(e,10)),moduleShouldInitialize:()=>1<s.length}}();i.default=a},{}],5:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=(e=e("../global/FtConfig"))&&e.__esModule?e:{default:e};i.default=function(e){var i=this;let a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"translating";const s={parent:"ft-activity-overlay-container",overlay:"ft-activity-overlay",error:"error",message:"message",flash:"flash",success:"success",activity:"activity",visible:"visible",activityContainer:"ft-activity",activityStaticText:"ft-activity-text",activityAnimationContainer:"ft-activity-animation-container",activityAnimationItem:"ft-activity-animation-item",messageContainer:"ft-activity-message"};let t,n,r;this.showActivity=()=>{this.setActivityActive(),this.setOverlayVisible()},this.showMessage=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:5e3;i.setMessageContent(e),i.setActivityInactive(),i.setMessageActive(),i.setOverlayVisible(),i.hide(t)},this.flashSuccess=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:500;i.setSuccessActive(),i.setFlashActive(),i.showMessage(e,t)},this.flashError=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:500;i.setFlashActive(),i.setErrorActive(),i.showMessage(e,t)},this.showError=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:7e3;i.setErrorActive(),i.showMessage(e,t)},this.hide=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;setTimeout(()=>{i.setOverlayInvisible()},e),setTimeout(()=>{i.setActivityInactive(),i.setMessageInactive(),i.setErrorInactive(),i.setFlashInactive(),i.setMessageContent("")},e+500)},this.setActivityActive=()=>{t.classList.add(s.activity)},this.setActivityInactive=()=>{t.classList.remove(s.activity)},this.setMessageActive=()=>{t.classList.add(s.message)},this.setMessageInactive=()=>{t.classList.remove(s.message)},this.setMessageContent=e=>{n.innerText=e},this.setFlashActive=e=>{t.classList.add(s.flash)},this.setFlashInactive=e=>{t.classList.remove(s.flash)},this.setSuccessActive=()=>{t.classList.add(s.success)},this.setSuccessInactive=()=>{t.classList.remove(s.success)},this.setErrorActive=()=>{t.classList.add(s.error)},this.setErrorInactive=()=>{t.classList.remove(s.error)},this.setOverlayVisible=()=>{t.classList.add(s.visible)},this.setOverlayInvisible=()=>{t.classList.remove(s.visible)},this.create=()=>(t=this.buildOverlayEl(),r=this.buildActivityEl(),n=this.buildMessageEl(),t.appendChild(r),t.appendChild(n),t),this.buildOverlayEl=()=>{var e=document.createElement("div");return e.setAttribute("class",s.overlay),e},this.buildActivityEl=()=>{var e=o.default.getUiTextFor("activityOverlay")[a];let t=document.createElement("div");t.setAttribute("class",s.activityAnimationContainer),t=e.animated.reduce((e,t)=>{var i=document.createElement("span");return i.setAttribute("class",s.activityAnimationItem),i.innerHTML=t,e.appendChild(i),e},t);var i=document.createElement("div");return i.setAttribute("class",s.activityStaticText),i.innerText=e.static,(r=document.createElement("div")).setAttribute("class",s.activityContainer),r.appendChild(i),r.appendChild(t),r},this.buildMessageEl=()=>((n=document.createElement("div")).setAttribute("class",s.messageContainer),n),e=e.getSelf(),t=this.create(),e.classList.add(s.parent),e.appendChild(t)}},{"../global/FtConfig":4}]},{},[2]);
//# sourceMappingURL=maps/fluency_api_usage.bundle.js.map
