!function(){let e,t;function a(e,t,a,n){Object.defineProperty(e,t,{get:a,set:n,enumerable:!0,configurable:!0})}var n="u">typeof globalThis?globalThis:"u">typeof self?self:"u">typeof window?window:"u">typeof global?global:{},s={},i={},r=n.parcelRequiree003;null==r&&((r=function(e){if(e in s)return s[e].exports;if(e in i){var t=i[e];delete i[e];var a={id:e,exports:{}};return s[e]=a,t.call(a.exports,a,a.exports),a.exports}var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,t){i[e]=t},n.parcelRequiree003=r);var l=r.register;l("gvk63",function(e,t){a(e.exports,"default",function(){return s});var n=r("iN3hH"),s=function(e,t="translating"){let a,s,i,r,l={parent:"ft-activity-overlay-container",overlay:"ft-activity-overlay",error:"error",message:"message",flash:"flash",activity:"activity",visible:"visible",activityContainer:"ft-activity",activityStaticText:"ft-activity-text",activityAnimationContainer:"ft-activity-animation-container",activityAnimationItem:"ft-activity-animation-item",messageContainer:"ft-activity-message"};this.showActivity=()=>{this.setActivityActive(),this.setOverlayVisible()},this.showMessage=(e,t=5e3)=>{this.setMessageContent(e),this.setActivityInactive(),this.setMessageActive(),this.setOverlayVisible(),this.hide(t)},this.flashSuccess=(e,t=500)=>{this.setSuccessActive(),this.setFlashActive(),this.showMessage(e,t)},this.flashError=(e,t=500)=>{this.setFlashActive(),this.setErrorActive(),this.showMessage(e,t)},this.showError=(e,t=5e3)=>{this.setErrorActive(),this.showMessage(e,t)},this.hide=(e=0)=>{setTimeout(()=>{this.setOverlayInvisible()},e),setTimeout(()=>{this.setActivityInactive(),this.setMessageInactive(),this.setErrorInactive(),this.setFlashInactive(),this.setMessageContent("")},e+500)},this.setActivityActive=()=>a.classList.add(l.activity),this.setActivityInactive=()=>a.classList.remove(l.activity),this.setMessageActive=()=>a.classList.add(l.message),this.setMessageInactive=()=>a.classList.remove(l.message),this.setMessageContent=e=>s.innerText=e,this.setFlashActive=()=>a.classList.add(l.flash),this.setFlashInactive=()=>a.classList.remove(l.flash),this.setSuccessActive=()=>a.classList.add(l.success),this.setSuccessInactive=()=>a.classList.remove(l.success),this.setErrorActive=()=>a.classList.add(l.error),this.setErrorInactive=()=>a.classList.remove(l.error),this.setOverlayVisible=()=>a.classList.add(l.visible),this.setOverlayInvisible=()=>a.classList.remove(l.visible),this.create=()=>(a=this.buildOverlayEl(),i=this.buildActivityEl(),s=this.buildMessageEl(),a.appendChild(i),a.appendChild(s),a),this.buildOverlayEl=()=>{let e=document.createElement("div");return e.setAttribute("class",l.overlay),e},this.buildActivityEl=()=>{let e=this.getActivityTexts(),t=document.createElement("div");t.setAttribute("class",l.activityAnimationContainer),t=e.animated.reduce((e,t)=>{let a=document.createElement("span");return a.setAttribute("class",l.activityAnimationItem),a.innerHTML=t,e.appendChild(a),e},t);let a=document.createElement("div");return a.setAttribute("class",l.activityStaticText),a.innerText=e.static,(i=document.createElement("div")).setAttribute("class",l.activityContainer),i.appendChild(a),i.appendChild(t),i},this.getActivityTexts=()=>{let e=n.default.getUiTextFor("activityOverlay")[t],a=e.animated;for(let e=a.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1)),n=a[e];a[e]=a[t],a[t]=n}return e.animated=a,e},this.buildMessageEl=()=>((s=document.createElement("div")).setAttribute("class",l.messageContainer),s),r=e.getSelf(),a=this.create(),r.classList.add(l.parent),r.appendChild(a)}}),l("iN3hH",function(e,t){let n,s,i,r,l,o,u,c,d,g;a(e.exports,"default",function(){return h});var h=(s=(n=ProcessWire.config.fluency).localization,i={translateButton:{container:"ft-translate-button-container",button:"ft-translate-button"},languageTranslator:{container:"Inputfield InputfieldHeaderHidden",content:"InputfieldContent ft-language-translator-button-content",translateButton:"ft-translate-all-button",sourceLanguageSelect:"uk-select ft-source-language-select",sourceLanguageSelectLabel:"ft-source-language-select-label"},statusPlaceholder:{container:"ft-translation-status-container",label:"ft-translation-status"},icon:"ft-icon"},r={activityOverlay:s.activityOverlay,languageSelect:s.languageSelect,inputfieldTranslateButtons:s.inputfieldTranslateButtons,standaloneTranslator:s.standaloneTranslator,usage:s.usage,errors:s.errors,languageTranslator:s.languageTranslator},l={languages:n.apiEndpoints.languages,translatableLanguagesCache:n.apiEndpoints.translatableLanguagesCache,test:n.apiEndpoints.test,translation:n.apiEndpoints.translation,translationCache:n.apiEndpoints.translationCache,usage:n.apiEndpoints.usage},o=n.configuredLanguages,u=n.unconfiguredLanguages,c=()=>o,d=()=>u,{fieldInitializedAttr:"data-ft-initialized",getApiEndpointFor:e=>l[e],getConfiguredLanguages:c,getDefaultLanguage:()=>c().reduce((e,t)=>t.default?t:e,null),getElementClassesFor:e=>i[e],getEngineInfo:g=()=>n.engine,getEngineProvidesUsageData:()=>g().providesUsageData,getLanguageCount:()=>c().length+d().length,getLanguageForId:e=>(e=parseInt(e,10),c().reduce((t,a)=>a.id===e?a:t,null)),getTranslationAction:()=>n.interface.inputfieldTranslationAction,getTranslationDisabledFieldAttribute:()=>`[${n.interface.translationDisabledFieldAttr}]`,getUiTextFor:e=>r[e],getUnconfiguredLanguages:d,languageIsTranslatable:e=>!d().includes(parseInt(e,10)),moduleShouldInitialize:()=>c().length>1,translationActionTypes:{each:"translate_each_language",all:"translate_to_all_languages",both:"both"}})}),l("75OpQ",function(e,t){let n,s,i;a(e.exports,"default",function(){return o});var l=r("iN3hH");r("aUodT");var o=(n=l.default.elementClasses,s=l.default.getUiTextFor("inputfieldTranslateButtons"),{createStatusElement:e=>{let t=l.default.getElementClassesFor("statusPlaceholder"),a=document.createElement("span");a.setAttribute("class",t.label),a.innerText=e;let n=document.createElement("div");return n.setAttribute("class",t.container),n.appendChild(i()),n.appendChild(a),n},createTranslateButton:e=>{let t=l.default.getElementClassesFor("translateButton"),a=document.createElement("a");a.innerText=e,a.setAttribute("class",t.button),a.setAttribute("href","");let n=document.createElement("div");return n.setAttribute("class",t.container),n.appendChild(i()),n.appendChild(a),{button:a,container:n}},createLanguageTranslatorInputs:()=>{let e=l.default.getElementClassesFor("languageTranslator"),t=l.default.getUiTextFor("languageTranslator"),a=document.createElement("a");a.innerText=t.translateAllButton,a.setAttribute("class",e.translateButton),a.setAttribute("href","");let n=document.createElement("select");n.setAttribute("class",e.sourceLanguageSelect),l.default.getConfiguredLanguages().forEach(function(e){let t=document.createElement("option");if(t.textContent=e.title,t.value=e.engineLanguage.sourceCode,e.default){t.selected="selected",n.prepend(t);return}n.appendChild(t)});let s=document.createElement("span");s.innerText=t.sourceLanguageSelectLabel;let i=document.createElement("label");i.setAttribute("class",e.sourceLanguageSelectLabel),i.appendChild(s),i.appendChild(n);let r=document.createElement("div");r.setAttribute("class",e.content),r.appendChild(a),r.appendChild(i);let o=document.createElement("li");return o.setAttribute("class",e.container),o.appendChild(r),{translateAllButton:a,sourceLanguageSelect:n,container:o}},createIcon:i=()=>{let e=document.createElement("a");e.setAttribute("href",`${ProcessWire.config.urls.admin}fluency/?modal=1`),e.setAttribute("class","pw-modal pw-modal-large");let t=document.createElement("i");return t.setAttribute("class",`${l.default.getElementClassesFor("icon")} fa fa-language`),t.setAttribute("uk-tooltip",s.showTranslator),e.appendChild(t),e},elementClasses:n})}),l("aUodT",function(e,t){let n,s,i,l,o,u,c;a(e.exports,"default",function(){return g});var d=r("iN3hH"),g=(n=d.default.getUiTextFor("errors"),s=e=>{let t={"X-Requested-With":"XMLHttpRequest"};return"GET"===e&&(t.Accept="application/json"),"POST"===e&&(t["Content-Type"]="application/json"),t},i=(e,t,a)=>fetch(e,{method:"POST",cache:"no-store",headers:s,body:JSON.stringify(t)}).then(u).then(a).catch(c),l=(e,t)=>fetch(e,{method:"GET",cache:"no-store",headers:s("GET")}).then(u).then(t).catch(c),o=(e,t)=>fetch(e,{method:"DELETE",headers:s("GET")}).then(u).then(t).catch(c),u=e=>{if(204===e.status)return e;if(e.ok)return e.json();throw Error()},c=e=>{console.error("[Fluency module API failure]",e.message);let t={error:null,message:null};return"NetworkError"===e.message.split(" ")[0]?(t.error="FLUENCY_CLIENT_DISCONNECTED",t.message=n.FLUENCY_CLIENT_DISCONNECTED):(t.error="UNKNOWN_ERROR",t.message=n.UNKNOWN_ERROR),t},{deleteTranslatableLanguagesCache:()=>o(d.default.getApiEndpointFor("translatableLanguagesCache"),e=>e),deleteTranslationCache:()=>o(d.default.getApiEndpointFor("translationCache"),e=>e),getAvailableLanguages:()=>l(d.default.getApiEndpointFor("languages"),e=>e),getTranslation:(e,t,a,n=[],s=null)=>i(d.default.getApiEndpointFor("translation"),{sourceLanguage:e,targetLanguage:t,content:a,options:n,caching:s},e=>e),getUsage:()=>l(d.default.getApiEndpointFor("usage"),e=>e)})});var o=r("gvk63"),u=r("75OpQ"),c=r("iN3hH"),d=r("aUodT");let g=(e=()=>{let e=document.querySelectorAll(".InputfieldContent");e&&[...e].forEach(e=>{e.querySelector("input.translatable, textarea.translatable")&&new p(e)})},t=()=>{new h(document.querySelector(".Inputfields"))},{init:()=>{e(),t()}}),h=function(e){let t,a=[];this.getSelf=()=>e,this.getActivityOverlay=()=>t,this.addLanguageTranslatorInputs=()=>{let{translateAllButton:e,sourceLanguageSelect:t,container:a}=u.default.createLanguageTranslatorInputs();this.sourceLanguageSelect=t,this.bindSourceLanguageSelect(t),this.bindTranslateButton(e),document.querySelector(".Inputfields").insertAdjacentElement("afterbegin",a)},this.bindSourceLanguageSelect=e=>{e.addEventListener("change",e=>{setTimeout(()=>{e.target.closest(".InputfieldStateChanged")?.classList.remove("InputfieldStateChanged")},100)})},this.bindTranslateButton=e=>{e.addEventListener("click",e=>{e.preventDefault(),this.translateContent()})},this.getGroupedContentForTranslation=()=>a.reduce((e,t,a)=>{let n=Math.floor(a/40);return e[n]||(e[n]=[]),e[n].push(t),e},[]),this.translateContent=()=>{let e=this.getGroupedContentForTranslation();t.showActivity();let a=e.length,n=parseInt(new URLSearchParams(window.location.search).get("language_id")),s=!1,i=this.sourceLanguageSelect.value;e.forEach((e,r)=>{s||d.default.getTranslation(i,c.default.getLanguageForId(n).engineLanguage.targetCode,e.map(e=>e.text)).then(a=>{if(a.error){s||(t.showError(a.message),s=!0);return}let n=a.translations;if(e.length!==n.length){t.showError("Error"),s=!0;return}for(let t=0;t<n.length;t++)e[t].input.value=n[t]}).then(e=>{0!=--a||s||t.hide()})})},this.mapSourceTargetElements=()=>{[...document.querySelectorAll(".InputfieldContent")].forEach(e=>{let t=e.querySelector(".description"),n=e.querySelector("input.translatable, textarea.translatable");n&&t&&t.innerText&&a.push({text:t.innerText,input:n})})},t=new(0,o.default)(this),this.mapSourceTargetElements(),this.addLanguageTranslatorInputs()},p=function(e){let t,a=c.default.getUiTextFor("inputfieldTranslateButtons"),n=e.querySelector(".description").innerText,s=e.querySelector("input, textarea");this.getSelf=()=>e,this.getActivityOverlay=()=>t,this.addLanguageTranslatorInputs=()=>{let{button:t,container:n}=u.default.createTranslateButton(a.translate);this.bindTranslateButton(t),e.appendChild(n)},this.bindTranslateButton=e=>{e.addEventListener("click",e=>{e.preventDefault(),this.translateContent()})},this.getSourceLanguageCode=()=>{let e=c.default.getElementClassesFor("languageTranslator").sourceLanguageSelect;return document.querySelector(`.${e.split(" ").join(".")}`).value},this.translateContent=()=>{let e=parseInt(new URLSearchParams(window.location.search).get("language_id"));t.showActivity(),d.default.getTranslation(this.getSourceLanguageCode(),c.default.getLanguageForId(e).engineLanguage.targetCode,n).then(e=>{e.error?t.showError(e.message):(s.value=e.translations[0],t.hide())})},t=new(0,o.default)(this),this.addLanguageTranslatorInputs()};var c=r("iN3hH");window.addEventListener("load",e=>{c.default.moduleShouldInitialize()&&g.init()})}();
//# sourceMappingURL=fluency_language_translator.js.map
