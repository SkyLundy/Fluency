!function(){let t;function e(t,e,a,i){Object.defineProperty(t,e,{get:a,set:i,enumerable:!0,configurable:!0})}var a="u">typeof globalThis?globalThis:"u">typeof self?self:"u">typeof window?window:"u">typeof global?global:{},i={},s={},n=a.parcelRequiree003;null==n&&((n=function(t){if(t in i)return i[t].exports;if(t in s){var e=s[t];delete s[t];var a={id:t,exports:{}};return i[t]=a,e.call(a.exports,a,a.exports),a.exports}var n=Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(t,e){s[t]=e},a.parcelRequiree003=n);var r=n.register;r("aUodT",function(t,a){let i,s,r,l,o,c,u;e(t.exports,"default",function(){return d});var g=n("iN3hH"),d=(i=g.default.getUiTextFor("errors"),s=t=>{let e={"X-Requested-With":"XMLHttpRequest"};return"GET"===t&&(e.Accept="application/json"),"POST"===t&&(e["Content-Type"]="application/json"),e},r=(t,e,a)=>fetch(t,{method:"POST",cache:"no-store",headers:s,body:JSON.stringify(e)}).then(c).then(a).catch(u),l=(t,e)=>fetch(t,{method:"GET",cache:"no-store",headers:s("GET")}).then(c).then(e).catch(u),o=(t,e)=>fetch(t,{method:"DELETE",headers:s("GET")}).then(c).then(e).catch(u),c=t=>{if(204===t.status)return t;if(t.ok)return t.json();throw Error()},u=t=>{console.error("[Fluency module API failure]",t.message);let e={error:null,message:null};return"NetworkError"===t.message.split(" ")[0]?(e.error="FLUENCY_CLIENT_DISCONNECTED",e.message=i.FLUENCY_CLIENT_DISCONNECTED):(e.error="UNKNOWN_ERROR",e.message=i.UNKNOWN_ERROR),e},{deleteTranslatableLanguagesCache:()=>o(g.default.getApiEndpointFor("translatableLanguagesCache"),t=>t),deleteTranslationCache:()=>o(g.default.getApiEndpointFor("translationCache"),t=>t),getAvailableLanguages:()=>l(g.default.getApiEndpointFor("languages"),t=>t),getTranslation:(t,e,a,i=[],s=null)=>r(g.default.getApiEndpointFor("translation"),{sourceLanguage:t,targetLanguage:e,content:a,options:i,caching:s},t=>t),getUsage:()=>l(g.default.getApiEndpointFor("usage"),t=>t)})}),r("iN3hH",function(t,a){let i,s,n,r,l,o,c,u,g,d;e(t.exports,"default",function(){return h});var h=(s=(i=ProcessWire.config.fluency).localization,n={translateButton:{container:"ft-translate-button-container",button:"ft-translate-button"},languageTranslator:{container:"Inputfield InputfieldHeaderHidden",content:"InputfieldContent ft-language-translator-button-content",translateButton:"ft-translate-all-button",sourceLanguageSelect:"uk-select ft-source-language-select",sourceLanguageSelectLabel:"ft-source-language-select-label"},statusPlaceholder:{container:"ft-translation-status-container",label:"ft-translation-status"},icon:"ft-icon"},r={activityOverlay:s.activityOverlay,languageSelect:s.languageSelect,inputfieldTranslateButtons:s.inputfieldTranslateButtons,standaloneTranslator:s.standaloneTranslator,usage:s.usage,errors:s.errors,languageTranslator:s.languageTranslator},l={languages:i.apiEndpoints.languages,translatableLanguagesCache:i.apiEndpoints.translatableLanguagesCache,test:i.apiEndpoints.test,translation:i.apiEndpoints.translation,translationCache:i.apiEndpoints.translationCache,usage:i.apiEndpoints.usage},o=i.configuredLanguages,c=i.unconfiguredLanguages,u=()=>o,g=()=>c,{fieldInitializedAttr:"data-ft-initialized",getApiEndpointFor:t=>l[t],getConfiguredLanguages:u,getDefaultLanguage:()=>u().reduce((t,e)=>e.default?e:t,null),getElementClassesFor:t=>n[t],getEngineInfo:d=()=>i.engine,getEngineProvidesUsageData:()=>d().providesUsageData,getLanguageCount:()=>u().length+g().length,getLanguageForId:t=>(t=parseInt(t,10),u().reduce((e,a)=>a.id===t?a:e,null)),getTranslationAction:()=>i.interface.inputfieldTranslationAction,getTranslationDisabledFieldAttribute:()=>`[${i.interface.translationDisabledFieldAttr}]`,getUiTextFor:t=>r[t],getUnconfiguredLanguages:g,languageIsTranslatable:t=>!g().includes(parseInt(t,10)),moduleShouldInitialize:()=>u().length>1,translationActionTypes:{each:"translate_each_language",all:"translate_to_all_languages",both:"both"}})}),r("gvk63",function(t,a){e(t.exports,"default",function(){return s});var i=n("iN3hH"),s=function(t,e="translating"){let a,s,n,r,l={parent:"ft-activity-overlay-container",overlay:"ft-activity-overlay",error:"error",message:"message",flash:"flash",activity:"activity",visible:"visible",activityContainer:"ft-activity",activityStaticText:"ft-activity-text",activityAnimationContainer:"ft-activity-animation-container",activityAnimationItem:"ft-activity-animation-item",messageContainer:"ft-activity-message"};this.showActivity=()=>{this.setActivityActive(),this.setOverlayVisible()},this.showMessage=(t,e=5e3)=>{this.setMessageContent(t),this.setActivityInactive(),this.setMessageActive(),this.setOverlayVisible(),this.hide(e)},this.flashSuccess=(t,e=500)=>{this.setSuccessActive(),this.setFlashActive(),this.showMessage(t,e)},this.flashError=(t,e=500)=>{this.setFlashActive(),this.setErrorActive(),this.showMessage(t,e)},this.showError=(t,e=5e3)=>{this.setErrorActive(),this.showMessage(t,e)},this.hide=(t=0)=>{setTimeout(()=>{this.setOverlayInvisible()},t),setTimeout(()=>{this.setActivityInactive(),this.setMessageInactive(),this.setErrorInactive(),this.setFlashInactive(),this.setMessageContent("")},t+500)},this.setActivityActive=()=>a.classList.add(l.activity),this.setActivityInactive=()=>a.classList.remove(l.activity),this.setMessageActive=()=>a.classList.add(l.message),this.setMessageInactive=()=>a.classList.remove(l.message),this.setMessageContent=t=>s.innerText=t,this.setFlashActive=()=>a.classList.add(l.flash),this.setFlashInactive=()=>a.classList.remove(l.flash),this.setSuccessActive=()=>a.classList.add(l.success),this.setSuccessInactive=()=>a.classList.remove(l.success),this.setErrorActive=()=>a.classList.add(l.error),this.setErrorInactive=()=>a.classList.remove(l.error),this.setOverlayVisible=()=>a.classList.add(l.visible),this.setOverlayInvisible=()=>a.classList.remove(l.visible),this.create=()=>(a=this.buildOverlayEl(),n=this.buildActivityEl(),s=this.buildMessageEl(),a.appendChild(n),a.appendChild(s),a),this.buildOverlayEl=()=>{let t=document.createElement("div");return t.setAttribute("class",l.overlay),t},this.buildActivityEl=()=>{let t=this.getActivityTexts(),e=document.createElement("div");e.setAttribute("class",l.activityAnimationContainer),e=t.animated.reduce((t,e)=>{let a=document.createElement("span");return a.setAttribute("class",l.activityAnimationItem),a.innerHTML=e,t.appendChild(a),t},e);let a=document.createElement("div");return a.setAttribute("class",l.activityStaticText),a.innerText=t.static,(n=document.createElement("div")).setAttribute("class",l.activityContainer),n.appendChild(a),n.appendChild(e),n},this.getActivityTexts=()=>{let t=i.default.getUiTextFor("activityOverlay")[e],a=t.animated;for(let t=a.length-1;t>0;t--){let e=Math.floor(Math.random()*(t+1)),i=a[t];a[t]=a[e],a[e]=i}return t.animated=a,t},this.buildMessageEl=()=>((s=document.createElement("div")).setAttribute("class",l.messageContainer),s),r=t.getSelf(),a=this.create(),r.classList.add(l.parent),r.appendChild(a)}});var l=n("aUodT"),o=n("iN3hH"),c=n("gvk63");let u={init:()=>{o.default.getEngineProvidesUsageData()&&[...document.querySelectorAll(`.ft-api-usage-table-fieldset:not([${t}])`)].forEach(t=>{new g(t)})},initializedAttr:t="data-ft-initialized"},g=function(t){let e,a={unit:"ft-usage-unit",limit:"ft-usage-limit",used:"ft-usage-used",remaining:"ft-usage-remaining",total:"ft-usage-total",refreshButton:"js-ft-refresh-usage"};for(let[i,s]of(this.getSelf=()=>t,this.updateView=()=>{e.showActivity(),l.default.getUsage().then(t=>{if(t.error)return void e.showError(t.message);let i=t=>t.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",");a.unit.innerText=t.unit,a.limit.innerText=i(t.limit),a.remaining.innerText=i(t.remaining),a.used.innerText=i(t.used),a.total.innerText=t.percentUsed,e.hide()})},this.bindRefreshButton=()=>{a.refreshButton.addEventListener("click",t=>{t.preventDefault(),this.updateView()})},Object.entries(a)))a[i]=t.querySelector(`.${s}`);e=new(0,c.default)(this,"refreshing"),this.bindRefreshButton(),t.setAttribute(u.initializedAttr,!0)};var o=n("iN3hH");window.addEventListener("load",t=>{o.default.getEngineProvidesUsageData()&&u.init()})}();
//# sourceMappingURL=fluency_api_usage.js.map
